Optimized Algorithm
-------------------

No local copy of arrays
Use register variables
