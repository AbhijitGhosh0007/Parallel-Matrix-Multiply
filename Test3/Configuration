Optimized Algorithm
-------------------

Local copy of arrays
Use register variables
